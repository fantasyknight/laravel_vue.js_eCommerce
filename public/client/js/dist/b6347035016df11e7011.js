(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{45:function(e,t,a){"use strict";a.r(t);var r=a(0),i=a.n(r),s=a(172),n=a(3);function o(e,t,a,r,i,s,n){try{var o=e[s](n),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var v,d,p={components:{VueTreeList:s.VueTreeList},props:{productId:Number,productName:String,reviews:Array,approvedReviewsCount:Number},data:function(){return{reviewRating:0,reviewContent:null,reviewEmail:null,reviewName:null,currentPage:1,perPage:10}},computed:c(c(c({},Object(n.c)("setting",["getProductSettings"])),Object(n.c)("user",["isCustomer","userName","getUser"])),{},{treeData:function(){for(var e,t,a=[],r=this.currentReviews.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage).reduce((function(e,t){if(0===t.parent){var r={id:t.id,name:t.author_name,approved:t.approved,content:t.content,date:t.created_at,rating:t.rating,dragDisabled:!0,addTreeNodeDisabled:!0,addLeafNodeDisabled:!0,editNodeDisabled:!0,delNodeDisabled:!0,children:[]};e.push(r),a.push({id:r.id,children:r.children})}return e}),[]);a.length;)e=a[a.length-1],a.pop(),this.currentReviews.filter((function(t){return t.parent===e.id})).forEach((function(r){t={id:r.id,name:r.author_name,approved:r.approved,content:r.content,date:r.created_at,rating:r.rating,dragDisabled:!0,addTreeNodeDisabled:!0,addLeafNodeDisabled:!0,editNodeDisabled:!0,delNodeDisabled:!0,children:[]},e.children.push(t),a.push({id:t.id,children:t.children})}));return new s.Tree(r)},currentReviews:function(){return this.reviews},total:function(){return this.currentReviews.length},shouldRender:function(){return this.total>this.perPage},lastPage:function(){return parseInt(this.total/this.perPage)+(this.total%this.perPage?1:0)},startIndex:function(){return!this.currentPage%this.perPage?this.currentPage:this.perPage*parseInt(this.currentPage/this.perPage)},pagesToBeShown:function(){for(var e=[],t=0;t<Math.min(this.lastPage-2,3);t++)this.currentPage<4||this.currentPage>this.lastPage-3?(this.currentPage<4&&(e[t]=t+2),this.lastPage>4&&this.currentPage>this.lastPage-3&&(e[t]=this.lastPage-3+t)):page[t]=this.currentPage-1+t;return e}}),created:function(){var e=JSON.parse(window.localStorage.getItem("product"));this.isCustomer?(this.reviewName=this.getUser.first_name+" "+this.getUser.last_name,this.reviewEmail=this.getUser.email):e&&(this.reviewName=e.name,this.reviewEmail=e.email)},methods:{selectRating:function(e){var t=e.target.parentNode;t.querySelector(".active")&&t.querySelector(".active").classList.remove("active"),e.target.classList.add("active"),this.reviewRating=parseInt(e.target.innerText)},productReview:(v=i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.$vToastify.removeToast(),this.$vToastify.setSettings({withBackdrop:!1,position:"top-right",successDuration:1500}),!this.getProductSettings.starRatingRequired||0!=this.reviewRating){e.next=5;break}return this.$vToastify.error("Ratings required"),e.abrupt("return");case 5:if(!this.currentReviews.find((function(e){return e.content==t.reviewContent&&e.author_email==t.reviewEmail}))){e.next=9;break}this.$vToastify.error("Duplicate comment detected; it looks as if you’ve already said that!"),e.next=14;break;case 9:return this.$vToastify.setSettings({withBackdrop:!0,position:"center-center"}),this.$vToastify.loader("Please wait..."),this.isCustomer?(this.reviewName=this.userName,this.reviewEmail=this.getUser.email):window.localStorage.setItem("product",JSON.stringify({name:this.reviewName,email:this.reviewEmail})),e.next=14,window.axios.post("/web/products/review",{product_id:this.productId,rating:this.reviewRating,content:this.reviewContent,author_name:this.reviewName,author_email:this.reviewEmail}).then((function(e){t.$vToastify.stopLoader(),t.currentReviews.push(c(c({},e.data.review),{},{parent:0})),e.data.review.approved&&t.$emit("new-approved-review"),t.reviewContent=""})).catch((function(e){t.$vToastify.stopLoader(),t.$vToastify.setSettings({withBackdrop:!1,position:"top-right",errorDuration:1500}),t.$vToastify.error("Comment could not be empty")}));case 14:case"end":return e.stop()}}),e,this)})),d=function(){var e=this,t=arguments;return new Promise((function(a,r){var i=v.apply(e,t);function s(e){o(i,a,r,s,n,"next",e)}function n(e){o(i,a,r,s,n,"throw",e)}s(void 0)}))},function(){return d.apply(this,arguments)}),findPage:function(e){this.currentPage=e}}},g=a(1),m=Object(g.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-reviews-content"},[a("h3",{staticClass:"reviews-title"},[e._v("\n        "+e._s(e.approvedReviewsCount>0?e.approvedReviewsCount+" review(s) for "+e.productName:"Reviews")+"\n    ")]),e._v(" "),e.currentReviews.length>0?a("div",{key:"exists",staticClass:"comment-list"},[a("vue-tree-list",{ref:"treeList",staticClass:"comments",attrs:{model:e.treeData,"default-expanded":!0},scopedSlots:e._u([{key:"leafNameDisplay",fn:function(t){return[a("div",{staticClass:"comment-block"},[a("div",{staticClass:"comment-header"},[a("div",{staticClass:"comment-arrow"}),e._v(" "),a("div",{staticClass:"ratings-container float-right"},[a("div",{staticClass:"product-ratings"},[a("span",{staticClass:"ratings",style:{width:20*t.model.rating+"%"}})])]),e._v(" "),a("span",{staticClass:"comment-by"},[a("strong",[e._v(e._s(t.model.name)+" –")]),e._v("\n                            "+e._s(t.model.date)+"\n                            "),t.model.approved?e._e():a("em",[e._v("Your comment is awating moderation")])])]),e._v(" "),a("div",{staticClass:"comment-content"},[a("p",{domProps:{innerHTML:e._s(t.model.content)}})])])]}},{key:"treeNodeIcon",fn:function(){return[a("div",{staticClass:"img-thumbnail"},[a("img",{attrs:{src:e.$root.getUrl("client/images/blog/author.png"),alt:"author",width:"80",height:"80"}})])]},proxy:!0}],null,!1,3484740084)}),e._v(" "),a("div",{staticClass:"mt-2"},[e.shouldRender?a("ul",{staticClass:"pagination justify-content-end mb-0"},[a("li",{staticClass:"page-item",class:{disabled:e.currentPage<2}},[a("a",{staticClass:"page-link page-link-btn",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.findPage(e.currentPage-1)}}},[a("i",{staticClass:"icon-angle-left"})])]),e._v(" "),a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",class:{active:1==e.currentPage},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.findPage(1)}}},[e._v(e._s(1))])]),e._v(" "),e.pagesToBeShown[0]>2?a("li",{staticClass:"page-item"},[a("span",{staticClass:"page-link"},[e._v("...")])]):e._e(),e._v(" "),e.pagesToBeShown.length?e._l(e.pagesToBeShown,(function(t){return a("li",{key:"page-"+t,staticClass:"page-item"},[a("a",{staticClass:"page-link",class:{active:e.currentPage==t},attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.findPage(t)}}},[e._v(e._s(t))])])})):e._e(),e._v(" "),e.pagesToBeShown[e.pagesToBeShown.length-1]<e.lastPage-1?a("li",{staticClass:"page-item"},[a("span",{staticClass:"page-link"},[e._v("...")])]):e._e(),e._v(" "),e.lastPage>1?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",class:{active:e.currentPage==e.lastPage},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.findPage(e.lastPage)}}},[e._v(e._s(e.lastPage))])]):e._e(),e._v(" "),a("li",{staticClass:"page-item",class:{disabled:e.currentPage===e.lastPage}},[a("a",{staticClass:"page-link page-link-btn",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.findPage(e.lastPage)}}},[a("i",{staticClass:"icon-angle-right"})])])],2):e._e()])],1):a("p",{key:"no-exist",staticClass:"no-reviews"},[e._v("\n        There are no reviews yet.\n    ")]),e._v(" "),a("div",{staticClass:"divider"}),e._v(" "),a("div",{staticClass:"add-product-review"},[a("h3",{staticClass:"review-title"},[e._v("\n            "+e._s(e.currentReviews.length>0?"Add a review":"Be the first to review “"+e.productName+"“")+"\n        ")]),e._v(" "),a("form",{staticClass:"comment-form m-0",attrs:{action:"#"},on:{submit:function(t){return t.preventDefault(),e.productReview.apply(null,arguments)}}},[e.isCustomer?a("p",{key:"customer",staticClass:"logged-in"},[a("router-link",{staticClass:"text-primary",attrs:{to:"/pages/account/details"}},[e.reviewName?[e._v("\n                        Logged in as\n                        "+e._s(e.reviewName)+".\n                    ")]:[e._v("You haven't set your name. Set your name\n                        first.")]],2),e._v(" "),a("router-link",{staticClass:"text-primary",attrs:{to:"/pages/account"}},[e._v("Log out?")])],1):e._e(),e._v(" "),a("div",{staticClass:"rating-form"},[a("label",{attrs:{for:"rating"}},[e._v("Your rating")]),e._v(" "),a("span",{staticClass:"rating-stars"},[a("a",{staticClass:"star-1",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectRating.apply(null,arguments)}}},[e._v("1")]),e._v(" "),a("a",{staticClass:"star-2",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectRating.apply(null,arguments)}}},[e._v("2")]),e._v(" "),a("a",{staticClass:"star-3",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectRating.apply(null,arguments)}}},[e._v("3")]),e._v(" "),a("a",{staticClass:"star-4",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectRating.apply(null,arguments)}}},[e._v("4")]),e._v(" "),a("a",{staticClass:"star-5",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectRating.apply(null,arguments)}}},[e._v("5")])])]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",[e._v("Your Review")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reviewContent,expression:"reviewContent"}],staticClass:"form-control form-control-sm",attrs:{cols:"5",rows:"6",maxlength:"1000",required:""},domProps:{value:e.reviewContent},on:{input:function(t){t.target.composing||(e.reviewContent=t.target.value)}}})]),e._v(" "),e.isCustomer?e._e():a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6 col-xl-12"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Your Name")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.reviewName,expression:"reviewName"}],staticClass:"form-control form-control-sm",attrs:{type:"text",required:"",maxlength:"250"},domProps:{value:e.reviewName},on:{input:function(t){t.target.composing||(e.reviewName=t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"col-md-6 col-xl-12"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Your E-mail")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.reviewEmail,expression:"reviewEmail"}],staticClass:"form-control form-control-sm",attrs:{type:"text",required:"",maxlength:"100"},domProps:{value:e.reviewEmail},on:{input:function(t){t.target.composing||(e.reviewEmail=t.target.value)}}})])])]),e._v(" "),a("input",{staticClass:"btn btn-primary font-weight-normal ls-n-15",attrs:{type:"submit",value:"Submit",disabled:e.isCustomer&&!e.reviewName}})])])])}),[],!1,null,null,null);t.default=m.exports}}]);